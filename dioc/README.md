# 測試Log分析器

一個功能強大的GUI工具，用於分析測試log檔案並生成詳細的報告。

## 功能特色

### 🔍 主要功能
- **自動分析測試Log檔案**：支援單一檔案或整個資料夾
- **智能分類**：自動將測試項目分類為PASS或FAIL
- **詳細資訊提取**：提取測試ID、指令、回應、執行時間等
- **腳本比對**：與Excel測試腳本進行比對分析
- **Excel匯出**：生成詳細的Excel報告

### 📊 分析內容
- **測項名稱**：如 `@STEP002@Get Qcode info FOR PEGA`
- **測試ID**：如 `B7PL025-002`
- **傳送指令**：如 `> :GetVal,"$QCODE"`
- **裝置回應**：如 `< N3C2401C`
- **執行結果**：PASS或FAIL
- **執行時間**：精確到毫秒
- **重試次數**：失敗項目的重試統計
- **錯誤訊息**：失敗原因的詳細說明

### 🎯 GUI介面
- **Tab分頁設計**：
  - ✅ PASS測試分析
  - ❌ FAIL測試分析  
  - 📊 腳本比對報告
  - 📄 原始Log內容
- **現代化介面**：直觀易用的操作體驗
- **即時統計**：即時顯示分析結果統計
- **進度提示**：大檔案處理時的進度顯示

## 安裝與使用

### 環境需求
- Python 3.7+
- Windows/Linux/macOS

### 安裝步驟
1. 安裝Python依賴套件：
```bash
pip install -r requirements.txt
```

2. 執行程式：
```bash
python main.py
```

### 使用說明

#### 1. 載入Log檔案
- **單一檔案**：點擊「選擇檔案」選擇.log檔案
- **整個資料夾**：點擊「選擇資料夾」選擇包含.log檔案的資料夾

#### 2. 載入測試腳本（可選）
- 點擊「選擇檔案」選擇Excel腳本檔案
- 支援.xlsx和.xls格式

#### 3. 開始分析
- 點擊「開始分析」按鈕
- 程式會自動解析Log內容並分類結果

#### 4. 查看結果
- **PASS測試**：查看所有成功通過的測試項目
- **FAIL測試**：查看失敗的測試項目及錯誤原因
- **腳本比對**：與Excel腳本進行比對分析
- **原始Log**：查看完整的原始Log內容

#### 5. 匯出報告
- 點擊「匯出Excel」生成詳細的Excel報告
- 包含多個工作表：PASS測試、FAIL測試、腳本比對報告、統計摘要

## 輸出格式

### Excel報告結構
- **Sheet1: PASS測試**
  | Step Name | Test ID | 指令 | 回應 | 結果 | 執行時間(秒) |

- **Sheet2: FAIL測試**
  | Step Name | Test ID | 指令 | 錯誤回應 | Retry次數 | 錯誤原因 | 執行時間(秒) |

- **Sheet3: 腳本比對報告**
  | Test ID | Status | Note |
  |---------|--------|------|
  | B7PL025-002 | ✅ PASS | 已執行且通過 |
  | B7PL025-003 | ❌ FAIL | 已執行但失敗 |
  | B7PL025-004 | ⚠️ NOT EXECUTED | 腳本中有但未執行 |

- **Sheet4: 統計摘要**
  | 項目 | 數值 |
  |------|------|
  | 總測試數 | 97 |
  | 通過數 | 85 |
  | 失敗數 | 12 |
  | 成功率 | 87.6% |

## 技術架構

### 核心模組
- **log_analyzer.py**：核心分析邏輯
- **gui_app.py**：GUI應用程式
- **requirements.txt**：Python依賴套件

### 分析邏輯
1. **Log解析**：使用正則表達式解析Log格式
2. **測項識別**：識別測試步驟和相關資訊
3. **結果分類**：根據關鍵字分類PASS/FAIL
4. **腳本比對**：與Excel腳本進行比對分析
5. **報告生成**：生成結構化的Excel報告

### 支援的Log格式
- 標準測試Log格式
- 包含時間戳記
- 支援多階段測試
- 支援重試機制
- 支援錯誤訊息

## 開發說明

### 程式架構
```
log_analyzer.py    # 核心分析器類別
gui_app.py        # GUI應用程式
requirements.txt   # 依賴套件清單
README.md         # 專案說明文件
```

### 主要類別
- **LogAnalyzer**：核心分析功能
- **LogAnalyzerGUI**：GUI介面管理

### 擴展功能
- 支援更多Log格式
- 自訂分析規則
- 批次處理功能
- 資料庫整合

## 版本歷史

### v1.0.1
- 搬移所有 Markdown 說明文件至 `dioc/`
- 更新程式中說明文件路徑（`main_enhanced.py`, `main_standard.py`）
- 維持 HTML 說明於 `docs/USER_GUIDE.html`
- 更新 EXE 檔版本資訊為 1.0.1.0（`assets/version_info.txt`）

### v1.0.0
- 初始版本發布
- 基本Log分析功能
- GUI介面
- Excel匯出功能
- 腳本比對功能

## 授權

本專案採用MIT授權條款。

## 聯絡資訊

如有問題或建議，請聯絡開發團隊。 