# 測試Log分析器 - 使用指南

## 🚀 快速開始

### 1. 啟動程式
```bash
python main.py
```

### 2. 基本操作流程

#### 步驟1：選擇Log檔案或資料夾
- **單一檔案**：點擊左側「選擇檔案」按鈕，選擇.log檔案
- **整個資料夾**：點擊左側「選擇資料夾」按鈕，選擇包含.log檔案的資料夾

#### 步驟2：選擇測試腳本（可選）
- 點擊「選擇腳本」按鈕，選擇Excel測試腳本檔案
- 支援.xlsx和.xls格式
- 腳本用於比對實際執行結果與預期測試項目

#### 步驟3：開始分析
- 點擊「開始分析」按鈕
- 程式會自動解析log內容並分類結果

#### 步驟4：查看結果
- **Tab1 - PASS測項**：查看所有成功通過的測試項目
- **Tab2 - FAIL測項**：查看失敗的測試項目及錯誤原因
- **Tab3 - 腳本比對**：與Excel腳本進行比對分析（需先載入腳本）
- **Tab4 - 原始LOG**：查看完整的原始log內容

#### 步驟5：調整介面（可選）
- 使用左側的「+」「-」按鈕調整字體大小（10-15）
- 拖拉左右視窗分隔線調整比例
- 設定會自動儲存到settings.json

#### 步驟6：匯出報告（多檔案模式）
- 點擊「匯出Excel」按鈕
- 選擇儲存位置
- 生成包含PASS/FAIL分頁的詳細Excel報告

---

## 📊 分析結果說明

### 單一檔案模式
- **若log包含失敗項目**：
  - Tab1顯示所有PASS測項
  - Tab2顯示最後一個FAIL項目（錯誤訊息標紅）
  - Tab4顯示原始log並跳轉到錯誤位置（錯誤行標紅）
  - 自動切換到FAIL分頁
- **若log全部通過**：
  - Tab1顯示所有測項
  - Tab2顯示空白
  - 自動切換到PASS分頁

### 多檔案模式
- Tab1顯示所有檔案的PASS測項
- Tab2顯示所有檔案的FAIL測項
- Tab4顯示提示訊息（不顯示原始內容）
- 可匯出Excel報告

### 腳本比對結果
- ✅ **PASS**：已執行且通過
- ❌ **FAIL**：已執行但失敗
- ⚠️ **NOT EXECUTED**：腳本中有但未執行
- ➕ **EXTRA**：執行但腳本中沒有

---

## 📋 Excel報告格式

### PASS測項工作表
| Step Name | 指令 | 回應 | 結果 |
|-----------|------|------|------|
| Get Qcode info FOR PEGA | :GetVal,"$QCODE" | N3C2401C | PASS |

### FAIL測項工作表
| Step Name | 指令 | 錯誤回應 | Retry次數 | 錯誤原因 |
|-----------|------|----------|-----------|----------|
| 測試項目 | 指令內容 | 錯誤回應 | 3 | 測試失敗 |

---

## 🔧 功能特色

### GUI介面
- **左右分割視窗**：可拖拉調整比例
- **Tab分頁設計**：清晰分類顯示結果
- **字體大小控制**：10-15範圍，即時調整
- **設定持久化**：自動儲存使用者偏好

### 分析功能
- **自動識別測項**：解析@STEP格式的測試步驟
- **指令回應提取**：提取>和<開頭的指令和回應
- **結果分類**：自動判斷Test is Pass/Fail
- **錯誤處理**：提取失敗原因和重試次數

### 腳本比對
- **智能比對**：比較實際執行與腳本預期
- **狀態標示**：不同顏色標示執行狀態
- **完整性檢查**：識別漏執行或額外執行的測試

---

## 🎯 使用技巧

### 1. 檔案組織建議
```
專案目錄/
├── LOG/                    # 存放log檔案
│   ├── test1.log
│   ├── test2.log
│   └── ...
├── 測試腳本.xlsx           # 測試腳本檔案
└── 分析結果/               # 匯出的Excel報告
```

### 2. 最佳實踐
- **單一檔案分析**：適合快速檢查特定測試結果
- **多檔案分析**：適合批次處理和生成報告
- **腳本比對**：確保測試完整性和一致性
- **定期匯出**：保存分析結果供後續參考

### 3. 故障排除
- **分析失敗**：檢查log檔案格式和編碼
- **腳本載入失敗**：確認Excel檔案格式正確
- **匯出失敗**：檢查目標資料夾寫入權限
- **GUI無回應**：等待大檔案分析完成

---

## 📝 支援的Log格式

程式支援包含以下元素的log格式：
- 測試步驟：`@STEP數字@測項名稱`
- 指令行：`> 指令內容`
- 回應行：`< 回應內容`
- 結果行：`Test is Pass` 或 `Test is Fail`
- 重試資訊：`Retry: 數字`

---

## 🔄 更新與維護

### 設定檔案
- `settings.json`：儲存字體大小等使用者偏好
- 可手動編輯或透過GUI調整

### 模組檔案
- `main.py`：主GUI應用程式
- `log_parser.py`：Log解析引擎
- `excel_writer.py`：Excel匯出功能
- `ui_components.py`：UI輔助元件
- `settings_loader.py`：設定管理

---

## 🎉 完成！

您的測試Log分析器已準備就緒！

**立即開始使用：**
```bash
python main.py
```

使用MINE/LOG目錄下的測試檔案來體驗所有功能。